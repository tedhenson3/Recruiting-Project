# a <- gsub("'", """, team, fixed = T)
sql <- paste("SELECT
player_full_name
FROM
`bigquery-public-data.ncaa_basketball.mbb_pbp_sr`
WHERE
team_market = ", team, sep = "")
ncaa = bq_project_query(query = sql, x = project)
library(bigrquery)
project <- "ncaa-shot-data-222316" # put your project ID here
team <- "St. John's"
# a <- gsub("'", """, team, fixed = T)
sql <- paste("SELECT
player_full_name
FROM
`bigquery-public-data.ncaa_basketball.mbb_pbp_sr`
WHERE
team_market = ", @team, sep = "")
ncaa = bq_project_query(query = sql, x = project)
library(bigrquery)
project <- "ncaa-shot-data-222316" # put your project ID here
team <- "St. John's"
# a <- gsub("'", """, team, fixed = T)
sql <- paste("SELECT
player_full_name
FROM
`bigquery-public-data.ncaa_basketball.mbb_pbp_sr`
WHERE
team_market = @team", sep = "")
ncaa = bq_project_query(query = sql, x = project)
library(bigrquery)
project <- "ncaa-shot-data-222316" # put your project ID here
team <- "St. John's"
# a <- gsub("'", """, team, fixed = T)
sql <- paste("DECLARE @team VARCHAR(50);
SET @team = ", team, "; SELECT
player_full_name
FROM
`bigquery-public-data.ncaa_basketball.mbb_pbp_sr`
WHERE
team_market = @team", sep = "")
ncaa = bq_project_query(query = sql, x = project)
?`dbSendQuery,BigQueryConnection,character-method`
library(bigrquery)
project <- "ncaa-shot-data-222316" # put your project ID here
team <- "St. John's"
# a <- gsub("'", """, team, fixed = T)
sql <- paste("SELECT
player_full_name
FROM
`bigquery-public-data.ncaa_basketball.mbb_pbp_sr`
WHERE
team_market = ?", sep = "")
airport <- dbSendQuery(con, sql)
library(bigrquery)
project <- "ncaa-shot-data-222316" # put your project ID here
team <- "St. John's"
# a <- gsub("'", """, team, fixed = T)
sql <- paste("SELECT
player_full_name
FROM
`bigquery-public-data.ncaa_basketball.mbb_pbp_sr`
WHERE
team_market = ?", sep = "")
airport <- dbSendQuery(con = project, sql)
airport <- dbSendQuery(con, "SELECT
player_full_name
FROM
`bigquery-public-data.ncaa_basketball.mbb_pbp_sr`
WHERE
team_market = ?")
airport <- dbSendQuery(con, "SELECT player_full_name FROM `bigquery-public-data.ncaa_basketball.mbb_pbp_sr` WHERE team_market = ?")
airport <- dbSendQuery(con = project, "SELECT player_full_name FROM `bigquery-public-data.ncaa_basketball.mbb_pbp_sr` WHERE team_market = ?")
airport <- dbSendQuery(billing = project, "SELECT player_full_name FROM `bigquery-public-data.ncaa_basketball.mbb_pbp_sr` WHERE team_market = ?")
airport <- dbSendQuery(con, billing = project, "SELECT player_full_name FROM `bigquery-public-data.ncaa_basketball.mbb_pbp_sr` WHERE team_market = ?")
airport <- dbSendQuery(con, billing = project, sql = "SELECT player_full_name FROM `bigquery-public-data.ncaa_basketball.mbb_pbp_sr` WHERE team_market = ?")
airport <- dbSendQuery(billing = project, sql = "SELECT player_full_name FROM `bigquery-public-data.ncaa_basketball.mbb_pbp_sr` WHERE team_market = ?")
?pnorm
pnorm(x = 1.5)
pnorm(q = 1.5)
1.75/2
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_nodes(css=css_tags) %>% html_text()
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_nodes(css=css.tags) %>% html_text()
View(stats)
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_nodes(css=css.tags) %>% html_text()
View(stats)
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_nodes(css=css.tags) %>% html_table()
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
stats
View(stats)
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
View(stats[[1]])
library(tidyverse)
library(rvest)
sports.ref.scraper <- function(player.ref){
library(tidyverse)
library(rvest)
css_tags <- 'p , h1'
stats = player.ref %>%
read_html() %>%
html_table()
}
url <- c("https://www.sports-reference.com/cbb/players/blake-harris-1.html")
#
sports.ref.scraper(url)
library(tidyverse)
library(rvest)
sports.ref.scraper <- function(player.ref){
library(tidyverse)
library(rvest)
css_tags <- 'p , h1'
stats = player.ref %>%
read_html() %>%
html_table()
#html_nodes(css=css_tags) %>% html_text()
print(stats)
}
url <- c("https://www.sports-reference.com/cbb/players/blake-harris-1.html")
#
sports.ref.scraper(url)
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- stats[[1]]
View(high.school)
(.2*.6) / ((.6*.2) + (.4*.4))
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- stats[[1]]
split <- strsplit(high.school$Name, ' - ')
print(split)
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
split
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
}
View(high.school)
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
year <- strsplit(split[[i]][2], "Sr")
print(year)
}
(.2*.6) / ((.6*.2) + (.4*1))
3/13
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
print(split[[i]][2])
}
?grepl
any(substring in split[[i]][2] for substring in substring_list)
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
substring_list <- c("Sr", "Jr", "So", "Fr")
junk <- split[[i]][2]
for(j in 1:length(substring_list)){
strsplit(junk, substring_list[j])
if(length(junk[[1]]) == 1){
print(junk)
}
}
}
substring_list[j]
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
substring_list <- c("Sr", "Jr", "So", "Fr")
junk <- split[[i]][2]
for(j in 1:length(substring_list)){
strsplit(junk, substring_list[j])
if(length(junk[[1]]) != 1){
print(junk)
}
}
}
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
substring_list <- c("Sr", "Jr", "So", "Fr")
junk <- split[[i]][2]
for(j in 1:length(substring_list)){
new.junk <- strsplit(junk, substring_list[j])
if(length(new.junk[[1]]) == 1){
print(new.junk[[1]])
}
}
}
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
substring_list <- c("Sr", "Jr", "So", "Fr")
junk <- split[[i]][2]
for(j in 1:length(substring_list)){
new.junk <- strsplit(junk, substring_list[j])
print(new.junk)
}
}
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
substring_list <- c("Sr", "Jr", "So", "Fr")
junk <- split[[i]][2]
while(j < 5){
new.junk <- strsplit(junk, substring_list[j])
new.junk <- new.junk[[1]]
if(length(new.junk) == 1){
high.school[i, 'Class'] <- substring_list[j]
}
if(length(new.junk) != 1){
j <- j + 1
}
}
View(high.school)
}
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
substring_list <- c("Sr", "Jr", "So", "Fr")
junk <- split[[i]][2]
while(j < 5){
new.junk <- strsplit(junk, substring_list[j])
new.junk <- new.junk[[1]]
if(length(new.junk) == 1){
high.school[i, 'Class'] <- substring_list[j]
}
if(length(new.junk) != 1){
j <- j + 1
}
}
}
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
substring_list <- c("Sr", "Jr", "So", "Fr")
junk <- split[[i]][2]
j <- 1
while(j < 5){
new.junk <- strsplit(junk, substring_list[j])
if(length(new.junk[[1]]) == 1){
high.school[i, 'Class'] <- substring_list[j]
j <- 5
}
if(length(new.junk[[1]]) != 1){
j <- j + 1
}
}
}
View(high.school)
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
substring_list <- c("Sr", "Jr", "So", "Fr")
junk <- split[[i]][2]
j <- 1
while(j < 5){
new.junk <- strsplit(junk, substring_list[j])
print(new.junk)
if(length(new.junk[[1]]) == 1){
high.school[i, 'Class'] <- substring_list[j]
j <- 5
}
if(length(new.junk[[1]]) != 1){
j <- j + 1
}
}
}
View(high.school)
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
substring_list <- c("Sr", "Jr", "So", "Fr")
junk <- split[[i]][2]
j <- 1
while(j < 5){
new.junk <- strsplit(junk, substring_list[j])
print(new.junk)
if(length(new.junk[[1]]) == 2){
high.school[i, 'Class'] <- substring_list[j]
j <- 5
}
if(length(new.junk[[1]]) == 1){
j <- j + 1
}
}
}
View(high.school)
bottom <- (.2*.7) + (.3*.4) + (.5*.3)
bottom
top = .7 * .2
top / bottom
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
substring_list <- c("Sr", "Jr", "So", "Fr")
junk <- split[[i]][2]
j <- 1
while(j < 5){
new.junk <- strsplit(junk, substring_list[j])
if(length(new.junk[[1]]) == 2){
high.school[i, 'Class'] <- substring_list[j]
j <- 5
}
if(length(new.junk[[1]]) == 1){
j <- j + 1
}
}
}
View(high.school)
maxpreps <- c("http://www.maxpreps.com/leaders/basketball-winter-16-17/,scoring/california/stat-leaders.htm?classyear=all&position=all")
css.tags <- '.dw , .name a'
library(tidyverse)
library(rvest)
stats = maxpreps %>%
read_html() %>%
html_table()
high.school <- as.data.frame(stats[[1]])
split <- strsplit(high.school$Name, ' - ')
for(i in 1:length(split)){
high.school[i, 'Name'] <-  split[[i]][1]
substring_list <- c("Sr", "Jr", "So", "Fr")
junk <- split[[i]][2]
j <- 1
while(j < 5){
new.junk <- strsplit(junk, substring_list[j])
if(length(new.junk[[1]]) == 2){
high.school[i, 'Class'] <- substring_list[j]
high.school[i, 'High.School'] <- new.junk[[1]][2]
j <- 5
}
if(length(new.junk[[1]]) == 1){
j <- j + 1
}
}
}
View(high.school)
setwd("~/analytics/recruiting project")
library(tidyverse)
library(readr)
rankings.espn <- read_csv(file = 'rankings.espn.csv')
rankings.247 <- read_csv(file = 'rankings.247.csv')
espn.247 <- full_join(rankings.espn, rankings.247, by = "player.id",
suffix = c(".espn", ".247"))
espn.247$School <- gsub("N Carolina", "UNC", espn.247$School)
espn.247$School <- gsub("Miss. St", "Mississippi State", espn.247$School)
espn.247$School <- gsub("W Kentucky", "Western Kentucky", espn.247$School)
espn.247$School <- gsub("W Kentucky", "Western Kentucky", espn.247$School)
rownames(espn.247) <- NULL
#View(espn.247)
source("~/analytics/recruiting project/basketball reference win share scraper.R")
espn.247 <- espn.247 %>% filter(!is.na(Name.espn) & School != 'unknown')
data <- wsscraper(data = espn.247)
View(data)
